(()=>{var e={612:(e,t,r)=>{"use strict";r.r(t),r.d(t,{colorizeHttpHistory:()=>s,observeHTTPRequests:()=>c});const{getSetting:n}=r(464);let o,a=0;const c=()=>{const e=document.querySelector(".c-table__wrapper");e&&(o&&(o.disconnect(),o=null),o=new MutationObserver((()=>{s()})),o.observe(e,{childList:!0,characterData:!0,subtree:!0}))},s=()=>{if("true"!==n("colorizeHttpRows"))return;const e=Date.now();e-a<50||(a=e,document.querySelectorAll('.c-item-cell[data-column-id="query"]').forEach((e=>l(e))))},l=e=>{const t=e.textContent,r=new URL("http://x.com?"+t).searchParams.get(n("colorizeParameterName")),o=e.parentElement.parentElement;r?(o.style.backgroundColor=r,o.setAttribute("colorized","true")):(o.style.backgroundColor="",o.setAttribute("colorized","false"))}},59:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{onScopeTabOpened:()=>o});const o=()=>{a(),c()},a=()=>{const e=document.querySelector(".c-preset-list__well");e&&(n&&(n.disconnect(),n=null),n=new MutationObserver((e=>{e.forEach((e=>{"data-is-active"===e.attributeName&&"true"===e.target.getAttribute("data-is-active")&&setTimeout((()=>s()),50),e.addedNodes.length>0&&e.addedNodes[0].classList.contains("c-preset-list__well-body")&&s()}))})),null!==document.querySelector(".c-preset-body__scope-form-value-input")&&s(),n.observe(e,{attributes:!0,childList:!0,subtree:!0}),console.log("Scope presents observer started"))},c=()=>{const e=document.querySelector(".c-scope-presets__body-actions");if(!e)return;document.querySelector("#scope-presents-import")?.remove();const t=e.children[0].cloneNode(!0);t.querySelector(".c-button__label").innerText="Import",t.id="scope-presents-import",t.style.width="5em",t.addEventListener("click",(()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.style.display="none",e.addEventListener("change",(e=>{const t=e.target.files[0],r=new FileReader;r.onload=e=>{const t=JSON.parse(e.target.result);l(t)},r.readAsText(t)})),document.body.prepend(e),e.click(),e.remove()})),e.appendChild(t)},s=()=>{const e=document.querySelector(".c-header__read-only");if(!e)return;document.querySelector("#scope-presents-export")?.remove();const t=document.createElement("div");t.innerHTML='\n        <svg fill="#fff" height="13px" width="13px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n                viewBox="0 0 492.022 492.022" xml:space="preserve">\n            <g id="XMLID_607_">\n                <path id="XMLID_609_" d="M317.88,113.728H58.729C26.348,113.728,0,140.078,0,172.459v259.15c0,32.381,26.348,58.729,58.729,58.729\n                    H317.88c32.381,0,58.728-26.348,58.728-58.729v-259.15C376.608,140.078,350.261,113.728,317.88,113.728z M307.958,421.687H68.651\n                    V182.378h239.307V421.687z"/>\n                <path id="XMLID_608_" d="M406.609,1.685H260.308c-18.956,0-34.325,15.369-34.325,34.324c0,18.956,15.369,34.326,34.325,34.326\n                    h146.302c9.236,0,16.762,7.525,16.762,16.76V233.4c0,18.955,15.368,34.324,34.325,34.324s34.326-15.369,34.326-34.324V87.095\n                    C492.022,40,453.706,1.685,406.609,1.685z"/>\n            </g>\n        </svg>',t.id="scope-presents-export",t.addEventListener("click",(()=>{const e=document.querySelectorAll(".c-scope-list__well-entry:not([data-header])");if(!e)return;const t=document.querySelector(".c-header__read-only label").textContent,r={presetName:t,allowlist:[],denylist:[]};e.forEach((e=>{const t=e.querySelector(".c-scope-list__well-entry-type").innerText,n=e.querySelector(".c-scope-list__well-entry-value").innerText;"In Scope"===t?r.allowlist.push(n):r.denylist.push(n)}));const n=JSON.stringify(r,null,2),o=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(o),c=document.createElement("a");c.href=a,c.download="scope-"+t+".json",c.click()})),e.appendChild(t)},l=e=>{const t={operationName:"createScope",query:"mutation createScope($input: CreateScopeInput!) {\n  createScope(input: $input) {\n    error {\n      ... on InvalidGlobTermsUserError {\n        ...invalidGlobTermsUserErrorFull\n      }\n      ... on OtherUserError {\n        ...otherUserErrorFull\n      }\n    }\n    scope {\n      ...scopeFull\n    }\n  }\n}\nfragment invalidGlobTermsUserErrorFull on InvalidGlobTermsUserError {\n  ...userErrorFull\n  terms\n}\nfragment userErrorFull on UserError {\n  __typename\n  code\n}\nfragment otherUserErrorFull on OtherUserError {\n  ...userErrorFull\n}\nfragment scopeFull on Scope {\n  __typename\n  id\n  name\n  allowlist\n  denylist\n  indexed\n}",variables:{input:{allowlist:e.allowlist,denylist:e.denylist,name:e.presetName}}};fetch("http://127.0.0.1:8080/graphql",{body:JSON.stringify(t),method:"POST",headers:{Authorization:"Bearer "+JSON.parse(localStorage.getItem("CAIDO_AUTHENTICATION")).accessToken}})}},464:(e,t,r)=>{"use strict";r.r(t),r.d(t,{checkForUpdates:()=>c,defaultSettings:()=>n,getSetting:()=>o,setSetting:()=>a});const n={colorizeParameterName:"_color",ssrfInstancePlaceholder:"$ssrfinstance",colorizeHttpRows:"true",sidebarHideGroups:"true",sidebarRearrangeGroups:"true",ssrfInstanceFunctionality:"true",evenBetterVersionCheckUrl:"https://raw.githubusercontent.com/bebiksior/EvenBetter/main/version.txt",currentVersion:"v1.3"},o=e=>null===localStorage.getItem(`evenbetter_${e}`)?n[e]:localStorage.getItem(`evenbetter_${e}`),a=(e,t)=>{localStorage.setItem(`evenbetter_${e}`,t)},c=async()=>{try{const e=await fetch(n.evenBetterVersionCheckUrl),t=await e.text();return t.trim()===n.currentVersion?"You are using the latest version! ðŸŽ‰":`New EvenBetter version available: ${t}.`}catch(e){return"Failed to check for updates"}}},832:(e,t,r)=>{"use strict";r.r(t),r.d(t,{evenBetterTab:()=>s});const{getSetting:n,setSetting:o}=r(464),{themes:a,loadTheme:c}=r(496),s=()=>{const e=n("theme"),t=document.createElement("div");let r;return t.innerHTML=`\n  \n  <div class="even-better__settings">\n    <div class="even-better__header">\n      <div class="even-better__header-title">EvenBetter - Settings</div>\n      <div class="even-better__header-description">Customize EvenBetter plugin here and make your Caido even better :D</div>\n    </div>\n    <div class="even-better__settings-content">\n        <div class="even-better__sidebar-tweaks">\n          <h2>Sidebar Tweaks</h2>\n          <p>Here you can tweak your sidebar :D</p>\n\n          <h3>Groups Hide Functionality</h3>\n          <p>\n            Choose if you want to use functionality that allows you to hide\n            sidebar groups by clicking on them.\n          </p>\n          <div class="activate--box">\n            <input type="checkbox" name="sidebarHideGroups" id="hidegroups"   ${"true"===n("sidebarHideGroups")?"checked":""} />\n            <label for="hidegroups">Activate</label>\n          </div>\n          <hr />\n          <h3>Groups Rearrange Functionality</h3>\n          <p>\n            Choose if you want to use functionality that allows you to rearrange\n            your sidebar groups.\n          </p>\n          <div class="activate--box">\n            <input\n              type="checkbox"\n              name="sidebarRearrangeGroups"\n              id="rearrangegroups"\n              ${"true"===n("sidebarRearrangeGroups")?"checked":""}\n            /> \n            <label for="rearrangegroups">Activate</label>\n          \n          </div>\n        </div>\n        <div class="even-better__colorize-http">\n          <h2>Colorize HTTP</h2>\n          <p>\n            Choose if you want to use colorize http functionality and specify the\n            parameter name\n          </p>\n\n          <div class="activate--box">\n            <input\n              type="checkbox"\n              name="colorizeHttpRows"\n              id="colorizehttp"\n              ${"true"===n("colorizeHttpRows")?"checked":""}\n            />\n            <label for="colorizehttp">Activate</label>\n          </div>\n\n          <br />\n          <label for="param">Parameter name</label>\n          <br />\n          <input type="text" name="colorizeParameterName" id="colorizeParameterName" placeholder="_color" />\n        </div>\n        <div class="even-better__quick-ssrf">\n          <h2>Quick SSRF Instance</h2>\n          <p>\n            Choose if you want to use quick ssrf instance functionality and\n            specify the placeholder\n          </p>\n\n          <div class="activate--box">\n            <input\n              type="checkbox"\n              name="ssrfInstanceFunctionality"\n              id="ssrfinstance"\n              ${"true"===n("ssrfInstanceFunctionality")?"checked":""}\n            />\n            <label for="ssrfinstance">Activate</label>\n          </div>\n          <br />\n          <label for="placeholder">Placeholder</label>\n          <br />\n          <input type="text" name="ssrfInstancePlaceholder" id="ssrfplaceholder" placeholder="$ssrfinstance" />\n        </div>\n        <div class="even-better__theme-section">\n          <h2>Theme</h2>\n          <p>Choose your Caido theme</p>\n          <select name="theme" class="even-better__theme-select">\n            ${Object.keys(a).map((t=>`<option value="${t}" ${e==t?"selected":""}>${a[t].name}</option>`)).join("")}\n          </select>\n        </div>\n      </div>\n    </div>`,t.id="evenbetter-settings-content",t.querySelector("#ssrfplaceholder").value=n("ssrfInstancePlaceholder"),t.querySelector("#colorizeParameterName").value=n("colorizeParameterName"),t.querySelector(".even-better__theme-select").addEventListener("change",(e=>{const t=e.target.value;o("theme",t),c(t)})),t.querySelectorAll("input[type=checkbox]").forEach((e=>{e.addEventListener("change",(e=>{const t=e.target.name,r=e.target.checked;o(t,r),location.reload()}))})),t.querySelectorAll("input[type=text]").forEach((e=>{e.addEventListener("input",(e=>{clearTimeout(r),r=setTimeout((()=>{const t=e.target.name,r=e.target.value;o(t,r),location.reload()}),1e3)}))})),t}},932:(e,t,r)=>{const{getSetting:n}=r(464),o=()=>{document.querySelectorAll(".c-sidebar-group").forEach((e=>{const t=e.children[0].textContent.trim(),r=e.getAttribute("data-is-group-collapsed");localStorage.setItem(`evenbetter_${t}_isCollapsed`,r)}))};e.exports={addGroupHideFunctionality:()=>{"true"===n("sidebarHideGroups")&&document.querySelectorAll(".c-sidebar-group__title").forEach((e=>{"..."!==e.textContent&&e.addEventListener("click",(()=>{const t=e.parentElement,r=t.querySelector(".c-sidebar-group__items");"true"===t.getAttribute("data-is-group-collapsed")?(r.style.display="block",t.setAttribute("data-is-group-collapsed","false")):(r.style.display="none",t.setAttribute("data-is-group-collapsed","true")),o()}))}))},restoreSidebarGroupCollapsedStates:()=>{"true"===n("sidebarHideGroups")&&document.querySelectorAll(".c-sidebar-group").forEach((e=>{const t=e.children[0].textContent.trim(),r=localStorage.getItem(`evenbetter_${t}_isCollapsed`);r&&(e.setAttribute("data-is-group-collapsed",r),e.querySelector(".c-sidebar-group__items").style.display="true"===r?"none":"block")}))},storeSidebarGroupCollapsedStates:o}},96:(e,t,r)=>{const{getSetting:n}=r(464),o=(e,t)=>{const r=Array.from(e.parentElement.children).indexOf(e);if("up"===t&&r>0||"down"===t&&r<e.parentElement.children.length-1){const n="up"===t?r-1:r+1;if(0==n)return;const o=e.parentElement.children[n+("up"===t?0:1)];e.parentElement.insertBefore(e,o),a()}},a=()=>{document.querySelectorAll(".c-sidebar-group").forEach((e=>{const t=e.children[0].textContent.trim(),r=Array.from(e.parentElement.children).indexOf(e);localStorage.setItem(`evenbetter_${t}_position`,r)}))};e.exports={addMoveButtonsToSidebar:()=>{"true"===n("sidebarRearrangeGroups")&&(document.querySelectorAll(".c-sidebar-group__title").forEach((e=>{const t=e.textContent;"..."!==t&&((e,t)=>{e.innerHTML=`\n        <div style="display:flex;justify-content:space-between;align-items:center;">${t}\n          <div class="c-sidebar-group__rearrange-arrows">\n              <svg class="c-sidebar-group__move-up" width="15px" height="15px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M12 5V19M12 5L6 11M12 5L18 11" stroke="#424242" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n              <svg class="c-sidebar-group__move-down" width="15px" height="15px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <path d="M12 5V19M12 19L6 13M12 19L18 13" stroke="#424242" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n          </div>\n        `})(e,t)})),document.querySelectorAll(".c-sidebar-group").forEach((e=>{const t=e.querySelector(".c-sidebar-group__move-up"),r=e.querySelector(".c-sidebar-group__move-down");t&&r&&(t.addEventListener("click",(t=>{o(e,"up"),t.stopPropagation()})),r.addEventListener("click",(t=>{o(e,"down"),t.stopPropagation()})))})))},restoreSidebarGroupPositions:()=>{"true"===n("sidebarRearrangeGroups")&&document.querySelectorAll(".c-sidebar-group").forEach((e=>{const t=e.children[0].textContent.trim(),r=localStorage.getItem(`evenbetter_${t}_position`);r&&e.parentElement.insertBefore(e,e.parentElement.children[r])}))},storeSidebarGroupPositions:a}},184:(e,t,r)=>{"use strict";r.r(t),r.d(t,{replaceSSRFInstanceText:()=>o});const{getSetting:n}=r(464),o=(e,t)=>{const r=t.replace(n("ssrfInstancePlaceholder"),"$creating_instance");e.target.textContent=r,fetch("https://api.cvssadvisor.com/ssrf/api/instance",{method:"POST"}).then((e=>e.json())).then((t=>{const n=r.replace("$creating_instance","https://"+t+".c5.rs");e.target.textContent=n,window.open("https://ssrf.cvssadvisor.com/instance/"+t,"_blank")})).catch((()=>{const t=r.replace("$creating_instance","$creating_instance_failed");e.target.textContent=t}))}},496:(e,t,r)=>{"use strict";r.r(t),r.d(t,{loadTheme:()=>o,themes:()=>n});const n={evendarker:{name:"Even Darker","--c-header-cell-border":"#101010","--c-bg-default":"#050607","--c-bg-subtle":"#090a0c","--c-table-item-row":"#08090a","--c-table-item-row-hover":"#0f1012","--header-cell-width":"1px","--c-table-even-item-row":"#08090a","--c-fg-default":"var(--c-white-100)","--c-fg-subtle":"var(--c-gray-400)","--replay-text-color":"#fff","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"var(--c-bg-default)"},caido:{name:"Caido Default","--c-header-cell-border":"#101010","--c-bg-default":"#25272d","--c-bg-subtle":"var(--c-gray-800)","--c-table-item-row":"#08090a","--c-table-item-row-hover":"#25272d","--header-cell-width":"0px","--c-table-even-item-row":"#353942","--c-fg-default":"var(--c-white-100)","--c-fg-subtle":"var(--c-gray-400)","--replay-text-color":"#fff","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"var(--c-bg-default)"},gray:{name:"Gray","--c-header-cell-border":"#101010","--c-bg-default":"#202020","--c-bg-subtle":"#252525","--c-table-item-row":"#252525","--c-table-item-row-hover":"#303030","--header-cell-width":"1px","--c-table-even-item-row":"#252525","--c-fg-default":"var(--c-white-100)","--c-fg-subtle":"var(--c-gray-400)","--replay-text-color":"#fff","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"var(--c-bg-default)"},oceanblue:{name:"Ocean Blue","--c-header-cell-border":"#116699","--c-bg-default":"#1a2b3c","--c-bg-subtle":"#2a3b4c","--c-table-item-row":"#1c2d3e","--c-table-item-row-hover":"#2a3b4c","--header-cell-width":"0px","--c-table-even-item-row":"#2c3d4e","--c-fg-default":"var(--c-white-100)","--c-fg-subtle":"var(--c-gray-400)","--replay-text-color":"#fff","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"var(--c-bg-default)"},solarized:{name:"Solarized","--c-header-cell-border":"#93a1a1","--c-bg-default":"#002b36","--c-bg-subtle":"#073642","--c-table-item-row":"#073642","--c-table-item-row-hover":"#586e75","--header-cell-width":"1px","--c-table-even-item-row":"#073642","--c-fg-default":"#93a1a1","--c-fg-subtle":"#657b83","--replay-text-color":"#fdf6e3","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"#073642"},black:{name:"Black","--c-header-cell-border":"#000000","--c-bg-default":"#111111","--c-bg-subtle":"#070707","--c-table-item-row":"#050505","--c-table-item-row-hover":"#222222","--header-cell-width":"0px","--c-table-even-item-row":"#111111","--c-fg-default":"var(--c-white-100)","--c-fg-subtle":"var(--c-gray-400)","--replay-text-color":"#fff","--selection-background":"rgba(255, 255, 255, 0.15)","--selected-row-background":"var(--c-bg-default)"}},o=e=>{const t=n[e];t&&Object.keys(t).forEach((e=>{document.documentElement.style.setProperty(e,t[e],"important")}))}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const{themes:e,loadTheme:t}=r(496),{addMoveButtonsToSidebar:n,restoreSidebarGroupPositions:o}=r(96),{getSetting:a,checkForUpdates:c}=r(464),{addGroupHideFunctionality:s,restoreSidebarGroupCollapsedStates:l}=r(932),{evenBetterTab:i}=r(832),{replaceSSRFInstanceText:d}=r(184),{observeHTTPRequests:u,colorizeHttpHistory:p}=r(612),{onScopeTabOpened:b}=r(59);let g;const v=e=>{switch(console.log("Tab opened: ",e),e){case"c-intercept":setTimeout((()=>{p(),u()}),50);break;case"c-replay":setTimeout((()=>S()),50);break;case"c-settings":setTimeout((()=>{m(),_()}),10);break;case"c-scope":setTimeout((()=>{b()}),10)}};let h;const m=()=>{const e=document.querySelector(".c-settings__navigation .c-underline-nav");e&&(h&&(h.disconnect(),h=null),h=new MutationObserver((e=>{e.forEach((e=>{"true"===e.target.getAttribute("data-is-active")&&y(e.target.textContent)}))})),h.observe(e,{subtree:!0,attributes:!0}))},y=e=>{console.log("Settings tab opened: ",e);const t=document.querySelector(".c-settings__content");switch(e){case"Developer":setTimeout((()=>{document.querySelector(".c-custom-js__footer").addEventListener("click",(()=>{setTimeout((()=>{location.reload()}),300)}))}),50);break;case"EvenBetter":return t.children[0].style.display="none",void t.appendChild(i())}document.querySelector("#evenbetter-settings-tab")?.setAttribute("data-is-active","false"),t.children[0].style.display="block",document.querySelector("#evenbetter-settings-content")?.remove()},f=e=>{"true"!==e.getAttribute("data-is-active")&&e.setAttribute("data-is-active","true"),Array.from(document.querySelector(".c-settings__navigation .c-underline-nav").children).filter((t=>t!==e)).forEach((e=>e.setAttribute("data-is-active","false")))},_=()=>{const e=document.querySelector(".c-settings__navigation .c-underline-nav");e.childNodes.forEach((e=>{e.addEventListener("click",(()=>{document.querySelector(".c-settings__content").children[0].style.display="block",f(e)}))}));const t=e.children[0].cloneNode(!0);t.querySelector(".c-button__label").textContent=t.textContent.replace("General","EvenBetter"),t.setAttribute("data-is-active","false"),t.id="evenbetter-settings-tab",t.addEventListener("click",(()=>{f(t)})),e.appendChild(t)};let w;const S=()=>{if("true"!==a("ssrfInstanceFunctionality"))return;const e=document.querySelector(".c-replay-entry .cm-content");e&&(w&&(w.disconnect(),w=null),w=new MutationObserver((e=>{e.forEach((e=>{const t=e.target.textContent;t.includes(a("ssrfInstancePlaceholder"))&&d(e,t)}))})),w.observe(e,{characterData:!0,subtree:!0}))};let x;const k=()=>{C(),t(a("theme")),n(),s(),(()=>{g&&(g.disconnect(),g=null);const e=document.querySelector(".c-content");g=new MutationObserver((e=>{e.forEach((e=>{if(e.removedNodes.length>0)return;if(0===e.addedNodes.length)return;const{target:t}=e;if(t.classList.contains("c-content")){const t=e.addedNodes[0];if(!t.classList)return;if(1===t.classList.length){const e=t.classList[0];if(!e.startsWith("c-"))return;v(e)}}}))})),g.observe(e,{subtree:!0,childList:!0})})(),x&&(x.disconnect(),x=null),x=new MutationObserver((e=>{e.forEach((e=>{"true"===e.target.getAttribute("data-is-collapsed")||(n(),s(),o(),l())}))})),x.observe(document.querySelector(".c-sidebar__toggle"),{attributes:!0,subtree:!0}),o(),l(),c().then((e=>{if(e.includes("New EvenBetter version available")){const e=document.createElement("div");e.id="evenbetter-update-status",e.textContent="[EvenBetter] Update available!",e.style.color="gray",document.querySelector(".c-global-actions").prepend(e)}}));const e=document.querySelector(".c-content")?.children[0]?.classList[0];e&&v(e),"c-settings"===e&&E()},E=()=>{const e=document.querySelector(".c-settings__content")?.children[0]?.classList[0],t=e.charAt(2).toUpperCase()+e.slice(3);document.querySelectorAll(".c-settings__navigation .c-underline-nav-item").forEach((e=>{e.textContent===t&&(f(e),y(t))}))},q=setInterval((()=>{document.querySelector(".c-sidebar__body")&&(clearInterval(q),k())}),100),C=()=>{const e=document.querySelector("#evenbetter-update-status");e&&(e.remove(),console.log("Update status removed"));const t=document.querySelector("#evenbetter-settings-content");t&&(t.remove(),console.log("Settings content removed"));const r=document.querySelector("#evenbetter-settings-tab");r&&(r.remove(),console.log("Settings tab removed"))}})()})();